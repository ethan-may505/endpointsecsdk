{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "type": "object",
  "properties": {
    "cve": {
      "type": "string",
      "pattern": "^CVE-[0-9]{4}-[0-9]{4,}$"
    },
    "v4_vid": {
      "type": "integer",
      "minimum": 100000,
      "maximum": 199999
    },
    "v4_pids": {
      "type": "array",
      "minItems": 1,
      "uniqueItems": true,
      "items": {
        "type": "integer",
        "minimum": 100000,
        "maximum": 199999
      }
    },
    "v4_signatures": {
      "type": "array",
      "minItems": 1,
      "uniqueItems": true,
      "items": {
        "type": "integer",
        "minimum": 100000,
        "maximum": 199999
      }
    },
    "os_type": {
      "type": "integer",
      "enum": [4]
    },
    "affected_os": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "os_name": {
            "type": "string",
            "pattern": "(?i)^(Sequoia|Sonoma|Ventura|Monterey|Big sur|Catalina|Mojave|High sierra)$"
          },
          "os_id": {
            "type": "integer",
            "minimum": 1013,
            "maximum": 1500
          },
          "ranges": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "object",
              "properties": {
                "start": {
                  "type": "string",
                  "pattern": "^\\d+(\\.\\d+){0,2}$"
                },
                "limit_except": {
                  "type": "string",
                  "pattern": "^\\d+(\\.\\d+){0,2}$"
                }
              },
              "required": ["start", "limit_except"],
              "additionalProperties": false
            }
          }
        },
        "required": ["os_name", "os_id", "ranges"],
        "additionalProperties": false
      }
    },
    "cpe": {
      "type": "string",
      "pattern": "^cpe:/o:[^:]+:[^:]+$"
    },
    "schema_version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+-\\d+\\.\\d+$"
    }
  },
  "required": [
    "cve",
    "cpe",
    "v4_vid",
    "v4_pids",
    "v4_signatures",
    "os_type",
    "affected_os",
    "schema_version"
  ],
  "additionalProperties": false
}