#pragma once

#include "vmod/wa_vmod_api.h"
#include "OesisUtils.h"
#include "OesisGenericProduct.h"

using namespace std;

class OesisVulnerabilityAndPatch: public OesisGenericProduct, public Singleton<OesisVulnerabilityAndPatch>
{
private:
    OesisFramework* oesis;
public:
    OesisVulnerabilityAndPatch();
    OesisVulnerabilityAndPatch(wstring downloadToken);
    int LoadPatchDatabase(wstring& json_out);
    int ConsumeOfflineVmodDatabase(wstring& json_out);
    int GetLatestInstaller(wstring& json_out, int download, string location);
    json GetProductPatchLevel();
    json GetProductVulnerability();
    json GetRemediations();
    json GetLatestInstaller(int download = 0, string location = "");
    json InstallFromFile(string path, int force_close = 0);
    ~OesisVulnerabilityAndPatch();
};
